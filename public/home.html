<!DOCTYPE html>
<html lang="ar" dir="rtl" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;600;700&display=swap');
    
    :root {
      --primary: linear-gradient(135deg, #475569 0%, #334155 100%);
      --accent: linear-gradient(135deg, #64748b 0%, #475569 100%);
      --success: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
      --info: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
      --warning: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      --danger: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      --purple: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      --edit: linear-gradient(135deg, #64748b 0%, #475569 100%);
      --glass: rgba(15, 23, 42, 0.8);
      --glass-light: rgba(30, 41, 59, 0.6);
      --border: rgba(148, 163, 184, 0.1);
      --border-light: rgba(148, 163, 184, 0.2);
      --text: #f8fafc;
      --text-secondary: #e2e8f0;
      --text-muted: #94a3b8;
      --shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
      --shadow-soft: 0 10px 25px rgba(0, 0, 0, 0.15);
    }
    
    * { box-sizing: border-box; }
    
    body { 
      font-family: 'Tajawal', sans-serif; 
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 40%, #334155 100%);
      background-attachment: fixed;
      color: var(--text);
      overflow-x: hidden;
    }
    
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: rgba(15, 23, 42, 0.3); border-radius: 10px; }
    ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #64748b 0%, #94a3b8 100%); }
    
    @keyframes fadeInUp { 0% { opacity: 0; transform: translateY(30px); } 100% { opacity: 1; transform: translateY(0); } }
    @keyframes slideInRight { 0% { opacity: 0; transform: translateX(30px); } 100% { opacity: 1; transform: translateX(0); } }
    @keyframes gentleShimmer { 0% { background-position: -200% center; } 100% { background-position: 200% center; } }
    @keyframes gentleFloat { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-8px); } }
    @keyframes gentlePulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.02); } }
    @keyframes countUp { 0% { transform: translateY(20px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } }
    @keyframes loadingShimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    
    .fade-up { opacity: 0; transform: translateY(30px); animation: fadeInUp 0.8s ease forwards; }
    .slide-right { opacity: 0; transform: translateX(30px); animation: slideInRight 0.6s ease forwards; }
    
    /* Enhanced Sidebar */
    .sidebar {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.95) 100%);
      backdrop-filter: blur(20px);
      border-left: 1px solid var(--border-light);
      box-shadow: var(--shadow);
    }
    
    .nav-link {
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      border-radius: 16px;
      margin: 4px 0;
      backdrop-filter: blur(10px);
    }
    
    .nav-link::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 0; height: 100%;
      background: var(--accent);
      transition: all 0.4s ease;
      z-index: -1;
      border-radius: 16px;
    }
    
    .nav-link:hover::before, .nav-link.active::before { width: 100%; }
    .nav-link:hover, .nav-link.active { 
      transform: translateX(-8px); 
      color: var(--text); 
      box-shadow: 0 8px 25px rgba(100, 116, 139, 0.3);
    }
    
    /* Enhanced Glass Cards */
    .glass-card, .modern-table-container, .page-header {
      background: var(--glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 32px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    
    .glass-card::before, .modern-table-container::before, .page-header::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: var(--accent);
      background-size: 200% 100%;
      animation: gentleShimmer 4s ease-in-out infinite;
    }
    
    /* Enhanced KPI Cards */
    .kpi-card {
      background: var(--glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 24px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
      transition: all 0.5s ease;
      cursor: pointer;
      text-align: center;
    }
    
    .kpi-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      transition: all 0.4s ease;
      border-radius: 24px 24px 0 0;
    }
    
    .kpi-card.suppliers::before { background: var(--warning); }
    .kpi-card.unpaid::before { background: var(--info); }
    .kpi-card.orders::before { background: var(--success); }
    .kpi-card.outstanding::before { background: var(--danger); }
    
    .kpi-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: var(--shadow);
    }
    
    .kpi-card:hover::before {
      height: 6px;
    }
    
    .kpi-icon {
      width: 48px;
      height: 48px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 16px auto;
      animation: gentleFloat 4s ease-in-out infinite;
    }
    
    .kpi-icon.suppliers { background: var(--warning); box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3); }
    .kpi-icon.unpaid { background: var(--info); box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3); }
    .kpi-icon.orders { background: var(--success); box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3); }
    .kpi-icon.outstanding { background: var(--danger); box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3); }
    
    .kpi-value {
      font-size: 2rem;
      font-weight: 700;
      line-height: 1;
      margin-bottom: 8px;
      animation: countUp 0.8s ease forwards;
      text-align: center;
    }
    
    .kpi-label {
      font-size: 0.875rem;
      color: var(--text-muted);
      font-weight: 500;
      text-align: center;
    }
    
    /* Search Input Styling */
    .search-input {
      background: rgba(100, 116, 139, 0.15) !important;
      border: 2px solid rgba(100, 116, 139, 0.4) !important;
      border-radius: 12px;
      padding: 12px 16px;
      color: #e2e8f0 !important;
      font-size: 14px;
      font-weight: 500;
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(100, 116, 139, 0.2) !important;
      text-align: right;
      direction: rtl;
      width: 100%;
    }
    
    .search-input:focus {
      outline: none !important;
      background: rgba(100, 116, 139, 0.2) !important;
      border-color: rgba(100, 116, 139, 0.6) !important;
      box-shadow: 0 0 20px rgba(100, 116, 139, 0.4) !important;
      transform: translateY(-1px);
      color: #f1f5f9 !important;
    }
    
    .search-input::placeholder {
      color: rgba(241, 245, 249, 0.7) !important;
      font-weight: 400;
      opacity: 0.9;
    }
    
    .search-input:hover {
      background: rgba(100, 116, 139, 0.18) !important;
      border-color: rgba(100, 116, 139, 0.5) !important;
      box-shadow: 0 6px 20px rgba(100, 116, 139, 0.25) !important;
    }
    
    /* Enhanced Supplier Cards */
    .supplier-card {
      background: var(--glass-light);
      backdrop-filter: blur(15px);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 24px;
      transition: all 0.5s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }
    
    .supplier-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: var(--accent);
      transform: scaleX(0);
      transition: transform 0.4s ease;
    }
    
    .supplier-card:hover::before {
      transform: scaleX(1);
    }
    
    .supplier-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 50px rgba(100, 116, 139, 0.2);
      border-color: var(--border-light);
    }
    
    .supplier-icon {
      width: 40px;
      height: 40px;
      background: var(--accent);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
      animation: gentlePulse 4s ease-in-out infinite;
      box-shadow: 0 8px 20px rgba(100, 116, 139, 0.3);
    }
    
    /* Enhanced Table */
    .modern-table-container {
      padding: 0;
      overflow: hidden;
    }
    
    .modern-table-container table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    
    .modern-table-container thead th {
      background: var(--primary);
      padding: 16px 24px;
      text-align: right;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.5px;
      color: var(--text);
      text-transform: uppercase;
      border-bottom: 2px solid var(--border);
    }
    
    .modern-table-container tbody tr {
      transition: all 0.3s ease;
      background: rgba(15, 23, 42, 0.3);
    }
    
    .modern-table-container tbody tr:nth-child(even) {
      background: rgba(30, 41, 59, 0.2);
    }
    
    .modern-table-container tbody tr:hover {
      background: rgba(100, 116, 139, 0.15);
      transform: translateY(-1px);
    }
    
    .modern-table-container tbody td {
      padding: 16px 24px;
      color: var(--text-secondary);
      font-size: 14px;
      border-bottom: 1px solid var(--border);
      transition: all 0.3s ease;
    }
    
    /* Modern Button */
    .modern-btn {
      background: var(--primary);
      color: var(--text);
      border: 1px solid var(--border);
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }
    
    .modern-btn::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s ease;
    }
    
    .modern-btn:hover::before { left: 100%; }
    .modern-btn:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      border-color: var(--border-light);
      color: var(--text);
      text-decoration: none;
    }
    
    .modern-btn.success { background: var(--success); box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3); }
    .modern-btn.warning { background: var(--warning); box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3); }
    .modern-btn.info { background: var(--info); box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3); }
    .modern-btn.edit { background: linear-gradient(135deg, #64748b 0%, #475569 100%); box-shadow: 0 8px 20px rgba(100, 116, 139, 0.3); }
    
    /* Grid utility for spanning full width */
    .col-span-full {
      grid-column: 1 / -1;
    }
    
    /* View All Link */
    .view-all-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      padding: 12px 20px;
      border-radius: 12px;
      background: rgba(100, 116, 139, 0.15);
      border: 1px solid var(--border);
      transition: all 0.4s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }
    
    .view-all-link::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s ease;
    }
    
    .view-all-link:hover::before { left: 100%; }
    .view-all-link:hover {
      background: rgba(100, 116, 139, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(100, 116, 139, 0.3);
      color: var(--text);
      text-decoration: none;
      border-color: var(--border-light);
    }
    
    /* Header Icon */
    .header-icon {
      background: var(--accent);
      box-shadow: 0 8px 20px rgba(100, 116, 139, 0.3);
      animation: gentlePulse 4s ease-in-out infinite;
    }
    
    /* Loading State for Numbers */
    .loading-number {
      background: linear-gradient(90deg, var(--border) 25%, rgba(148, 163, 184, 0.3) 50%, var(--border) 75%);
      background-size: 200% 100%;
      animation: loadingShimmer 1.5s infinite;
      border-radius: 8px;
      height: 2rem;
      width: 4rem;
    }
    
    /* Message Styles */
    .message {
      padding: 12px 16px;
      border-radius: 8px;
      margin: 8px 0;
      display: none;
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      min-width: 300px;
    }
    
    .success-message {
      background: rgba(34, 197, 94, 0.2);
      border: 1px solid rgba(34, 197, 94, 0.3);
      color: #22c55e;
    }
    
    .error-message {
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #ef4444;
    }
    
    .loading-message {
      background: rgba(14, 165, 233, 0.2);
      border: 1px solid rgba(14, 165, 233, 0.3);
      color: #0ea5e9;
    }
    
    /* Recent Items */
    .recent-item {
      background: var(--glass-light);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin: 8px 0;
      display: flex;
      justify-content: between;
      align-items: center;
      transition: all 0.3s ease;
    }
    
    .recent-item:hover {
      background: rgba(100, 116, 139, 0.15);
      transform: translateY(-1px);
    }
    
    .recent-item-info {
      flex: 1;
    }
    
    .recent-item-info h4 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }
    
    .recent-item-info p {
      font-size: 12px;
      color: var(--text-muted);
      margin: 2px 0;
    }
    
    .recent-item-status {
      margin-right: 16px;
    }
    
    .status-pending { background: var(--warning); color: white; padding: 4px 8px; border-radius: 6px; font-size: 10px; }
    .status-paid { background: var(--success); color: white; padding: 4px 8px; border-radius: 6px; font-size: 10px; }
    .status-overdue { background: var(--danger); color: white; padding: 4px 8px; border-radius: 6px; font-size: 10px; }
    .status-completed { background: var(--success); color: white; padding: 4px 8px; border-radius: 6px; font-size: 10px; }
    
    .no-data {
      text-align: center;
      color: var(--text-muted);
      padding: 40px;
      font-style: italic;
    }
    
    /* Notifications */
    .notification-item {
      background: var(--glass-light);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      margin: 8px 0;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      transition: all 0.3s ease;
    }
    
    .notification-item:hover {
      background: rgba(100, 116, 139, 0.15);
    }
    
    .notification-icon {
      font-size: 20px;
      margin-top: 2px;
    }
    
    .notification-content {
      flex: 1;
    }
    
    .notification-content h4 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }
    
    .notification-content p {
      font-size: 12px;
      color: var(--text-muted);
      margin: 2px 0;
    }
    
    .notification-content small {
      font-size: 10px;
      color: var(--text-muted);
    }
    
    .mark-read {
      background: var(--success);
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
    }
    
    /* Notification Badge */
    .notification-badge {
      background: var(--danger);
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 10px;
      position: absolute;
      top: -5px;
      left: -5px;
      display: none;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .glass-card, .page-header { padding: 24px 20px; }
      .kpi-card { padding: 20px; }
      .supplier-card { padding: 20px; }
      .kpi-value { font-size: 1.75rem; }
      .modern-table-container thead th,
      .modern-table-container tbody td { padding: 12px 16px; font-size: 12px; }
    }
  </style>
</head>
<body class="flex bg-gray-900 text-gray-100 min-h-screen">
  <!-- Loading Message -->
  <div id="loading" class="message loading-message">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
  
  <!-- Success Message -->
  <div id="success-message" class="message success-message"></div>
  
  <!-- Error Message -->
  <div id="error-message" class="message error-message"></div>

  <!-- Sidebar -->
  <aside class="sidebar w-64 flex flex-col p-8 hidden md:block">
    <div class="text-center mb-12">
      <h1 class="text-3xl font-bold bg-gradient-to-r from-slate-400 via-slate-300 to-slate-500 bg-clip-text text-transparent">Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h1>
      <div class="w-20 h-1 bg-gradient-to-r from-slate-500 to-slate-400 mx-auto mt-3 rounded-full"></div>
    </div>
    <nav class="space-y-4 flex-1">
      <a href="home.html" class="nav-link active block py-4 px-6">
        <span class="relative z-10 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
          </svg>
          Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        </span>
      </a>
      <a href="add.html" class="nav-link block py-4 px-6">
        <span class="relative z-10 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
          </svg>
          Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©
        </span>
      </a>
      <a href="view.html" class="nav-link block py-4 px-6">
        <span class="relative z-10 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
          Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
        </span>
      </a>
      <a href="purchase-orders.html" class="nav-link block py-4 px-6">
        <span class="relative z-10 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
          </svg>
          Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
        </span>
      </a>
    </nav>
    
    <!-- Refresh Button -->
    <div class="mt-auto">
      <button id="refresh-btn" class="modern-btn w-full justify-center">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg>
        ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8 space-y-8">
    <!-- Page Header -->
    <section class="page-header fade-up">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h2 class="text-3xl font-bold bg-gradient-to-r from-slate-300 via-slate-200 to-slate-400 bg-clip-text text-transparent mb-2">Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
          <p class="text-slate-400 text-base">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±</p>
        </div>
        <div class="hidden md:block relative">
          <div class="w-16 h-16 header-icon rounded-2xl flex items-center justify-center">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
            </svg>
          </div>
          <!-- Notification Badge -->
          <span id="notification-badge" class="notification-badge">0</span>
        </div>
      </div>
    </section>

    <!-- KPI Cards -->
    <section class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 fade-up" style="animation-delay: 0.1s;">
      <div class="kpi-card suppliers">
        <div class="kpi-icon suppliers">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
          </svg>
        </div>
        <div class="kpi-value text-yellow-300" id="total-suppliers">0</div>
        <div class="kpi-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</div>
      </div>

      <div class="kpi-card unpaid">
        <div class="kpi-icon unpaid">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
        </div>
        <div class="kpi-value text-blue-300" id="total-invoices">0</div>
        <div class="kpi-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</div>
      </div>

      <div class="kpi-card orders">
        <div class="kpi-icon orders">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
          </svg>
        </div>
        <div class="kpi-value text-green-300" id="total-purchase-orders">0</div>
        <div class="kpi-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡</div>
      </div>

      <div class="kpi-card outstanding">
        <div class="kpi-icon outstanding">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
          </svg>
        </div>
        <div class="kpi-value text-red-300" id="remaining-amount">0 Ø±.Ø³</div>
        <div class="kpi-label">Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø©</div>
      </div>
    </section>

    <!-- Recent Invoices and Payments -->
    <div class="grid gap-6 grid-cols-1 lg:grid-cols-2 fade-up" style="animation-delay: 0.2s;">
      <!-- Recent Invoices -->
      <section class="glass-card">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h3 class="text-2xl font-bold text-slate-200 mb-2">Ø£Ø­Ø¯Ø« Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>
            <p class="text-slate-400 text-sm">Ø¢Ø®Ø± 5 ÙÙˆØ§ØªÙŠØ± ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§</p>
          </div>
        </div>
        <div id="recent-invoices">
          <!-- Recent invoices will be rendered here -->
        </div>
      </section>

      <!-- Recent Payments -->
      <section class="glass-card">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h3 class="text-2xl font-bold text-slate-200 mb-2">Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</h3>
            <p class="text-slate-400 text-sm">Ø¢Ø®Ø± 5 Ù…Ø¯ÙÙˆØ¹Ø§Øª ØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡Ø§</p>
          </div>
        </div>
        <div id="recent-payments">
          <!-- Recent payments will be rendered here -->
        </div>
      </section>
    </div>

    <!-- Notifications Section -->
    <section class="glass-card fade-up" style="animation-delay: 0.3s;">
      <div class="flex items-center justify-between mb-6">
        <div>
          <h3 class="text-2xl font-bold text-slate-200 mb-2">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
          <p class="text-slate-400 text-sm">Ø¢Ø®Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙˆØ§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</p>
        </div>
      </div>
      <div id="notifications">
        <!-- Notifications will be rendered here -->
      </div>
    </section>

    <!-- Latest Invoices Table -->
    <section class="glass-card fade-up" style="animation-delay: 0.4s;">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6">
        <div>
          <h3 class="text-2xl font-bold text-slate-200 mb-2">Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>
          <p class="text-slate-400 text-sm">Ø¹Ø±Ø¶ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø­Ø¯ÙŠØ«Ø©</p>
        </div>
        <div class="flex items-center gap-4 w-full md:w-auto">
          <div class="relative flex-1 md:max-w-sm">
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
            <input id="invoiceSearch" type="text" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ±..." class="search-input pr-10" />
          </div>
          <a href="add.html" class="modern-btn info whitespace-nowrap">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©
          </a>
        </div>
      </div>
      
      <div class="modern-table-container">
        <table>
          <thead>
            <tr>
              <th>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
              <th>Ø§Ù„Ù…ÙˆØ±Ø¯</th>
              <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
              <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
            </tr>
          </thead>
          <tbody id="invoice-tbody">
            <!-- Invoice rows will be rendered here -->
          </tbody>
        </table>
      </div>
      
      <div class="mt-6 text-center">
        <a href="view.html" class="view-all-link">
          <span>Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</span>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </section>
  </main>

  <script>
    // ===== Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø£ÙƒÙˆØ§Ø¯ localStorage ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ù€ API =====

    // ==== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ù† API ====
    async function loadDashboardStats() {
        try {
            showLoading('ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...');
            
            const response = await fetch('/api/dashboard/stats');
            if (response.ok) {
                const stats = await response.json();
                displayDashboardStats(stats);
                hideLoading();
                return stats;
            } else {
                hideLoading();
                showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª');
                return null;
            }
        } catch (error) {
            hideLoading();
            showError('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©: ' + error.message);
            return null;
        }
    }

    // ==== Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ====
    function displayDashboardStats(stats) {
        // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
        const totalInvoicesElement = document.getElementById('total-invoices');
        if (totalInvoicesElement) {
            animateNumber(totalInvoicesElement, stats.totalInvoices || 0);
        }
        
        // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº
        const totalAmountElement = document.getElementById('total-amount');
        if (totalAmountElement) {
            totalAmountElement.textContent = `${(stats.totalAmount || 0).toLocaleString('ar-SA')} Ø±.Ø³`;
        }
        
        // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª
        const totalPaymentsElement = document.getElementById('total-payments');
        if (totalPaymentsElement) {
            totalPaymentsElement.textContent = `${(stats.totalPayments || 0).toLocaleString('ar-SA')} Ø±.Ø³`;
        }
        
        // Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†
        const totalSuppliersElement = document.getElementById('total-suppliers');
        if (totalSuppliersElement) {
            animateNumber(totalSuppliersElement, stats.totalSuppliers || 0);
        }
        
        // Ø¹Ø¯Ø¯ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
        const totalPurchaseOrdersElement = document.getElementById('total-purchase-orders');
        if (totalPurchaseOrdersElement) {
            animateNumber(totalPurchaseOrdersElement, stats.totalPurchaseOrders || 0);
        }
        
        // Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
        const pendingInvoicesElement = document.getElementById('pending-invoices');
        if (pendingInvoicesElement) {
            animateNumber(pendingInvoicesElement, stats.pendingInvoices || 0);
        }
        
        // Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©
        const overdueInvoicesElement = document.getElementById('overdue-invoices');
        if (overdueInvoicesElement) {
            animateNumber(overdueInvoicesElement, stats.overdueInvoices || 0);
        }
        
        // Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
        const remainingAmountElement = document.getElementById('remaining-amount');
        if (remainingAmountElement) {
            const remaining = (stats.totalAmount || 0) - (stats.totalPayments || 0);
            remainingAmountElement.textContent = `${remaining.toLocaleString('ar-SA')} Ø±.Ø³`;
        }
    }

    // ==== ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ± ====
    async function loadRecentInvoices() {
        try {
            const response = await fetch('/api/invoices?limit=5&sort=createdAt:desc');
            if (response.ok) {
                const invoices = await response.json();
                displayRecentInvoices(invoices);
                displayInvoicesTable(invoices); // Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø£ÙŠØ¶Ø§Ù‹
                return invoices;
            }
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ±:', error);
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const container = document.getElementById('recent-invoices');
            if (container) {
                container.innerHTML = '<p class="no-data">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>';
            }
        }
    }

    // ==== Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ± ====
    function displayRecentInvoices(invoices) {
        const container = document.getElementById('recent-invoices');
        if (!container) return;
        
        container.innerHTML = '';
        
        if (invoices.length === 0) {
            container.innerHTML = '<p class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ± Ø­Ø¯ÙŠØ«Ø©</p>';
            return;
        }
        
        invoices.forEach(invoice => {
            const item = document.createElement('div');
            item.className = 'recent-item';
            item.innerHTML = `
                <div class="recent-item-info">
                    <h4>ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù…: ${invoice.invoice_number || invoice.invoiceNo || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</h4>
                    <p>Ø§Ù„Ù…ÙˆØ±Ø¯: ${invoice.Supplier?.name || invoice.supplier || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                    <p>Ø§Ù„Ù…Ø¨Ù„Øº: ${parseFloat(invoice.total_amount || invoice.totalAmount || 0).toLocaleString('ar-SA')} ${invoice.currency || 'Ø±.Ø³'}</p>
                    <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${formatDate(invoice.issue_date || invoice.date)}</p>
                </div>
                <div class="recent-item-status">
                    <span class="status-${invoice.status || 'pending'}">${getStatusText(invoice.status || 'pending')}</span>
                </div>
            `;
            container.appendChild(item);
        });
    }

    // ==== Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ====
    function displayInvoicesTable(invoices) {
        const tbody = document.getElementById('invoice-tbody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        if (invoices.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="text-center py-12 text-slate-400">
                        <div class="flex flex-col items-center gap-4">
                            <svg class="w-12 h-12 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <div>
                                <p class="font-semibold mb-1">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ± Ø¨Ø¹Ø¯</p>
                                <p class="text-sm">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ ÙØ§ØªÙˆØ±Ø©</p>
                            </div>
                            <a href="add.html" class="modern-btn info">Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</a>
                        </div>
                    </td>
                </tr>
            `;
            return;
        }
        
        invoices.forEach((invoice, index) => {
            const row = document.createElement('tr');
            row.className = 'fade-up';
            row.style.animationDelay = `${index * 0.1}s`;
            
            const invoiceNumber = invoice.invoice_number || invoice.invoiceNo || invoice.number || invoice.id || '-';
            const supplier = invoice.Supplier?.name || invoice.supplier || '-';
            const date = invoice.issue_date || invoice.date || '-';
            const amount = invoice.total_amount || invoice.totalAmount || 0;
            const status = invoice.status || 'pending';
            
            row.innerHTML = `
                <td class="font-semibold text-slate-300">${invoiceNumber}</td>
                <td class="text-slate-400">${supplier}</td>
                <td class="text-slate-400">${formatDate(date)}</td>
                <td class="font-mono font-bold text-slate-300">${formatCurrency(amount)}</td>
                <td><span class="status-${status}">${getStatusText(status)}</span></td>
            `;
            
            tbody.appendChild(row);
        });
    }

    // ==== ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ====
    async function loadRecentPayments() {
        try {
            const response = await fetch('/api/payments?limit=5&sort=createdAt:desc');
            if (response.ok) {
                const payments = await response.json();
                displayRecentPayments(payments);
                return payments;
            }
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª:', error);
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const container = document.getElementById('recent-payments');
            if (container) {
                container.innerHTML = '<p class="no-data">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>';
            }
        }
    }

    // ==== Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ====
    function displayRecentPayments(payments) {
        const container = document.getElementById('recent-payments');
        if (!container) return;
        
        container.innerHTML = '';
        
        if (payments.length === 0) {
            container.innerHTML = '<p class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø­Ø¯ÙŠØ«Ø©</p>';
            return;
        }
        
        payments.forEach(payment => {
            const item = document.createElement('div');
            item.className = 'recent-item';
            item.innerHTML = `
                <div class="recent-item-info">
                    <h4>Ø¯ÙØ¹Ø©: ${payment.Invoice?.invoice_number || payment.invoiceNumber || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</h4>
                    <p>Ø§Ù„Ù…Ø¨Ù„Øº: ${parseFloat(payment.amount || 0).toLocaleString('ar-SA')} ${payment.currency || 'Ø±.Ø³'}</p>
                    <p>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©: ${payment.payment_method || payment.method || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                    <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${formatDate(payment.payment_date || payment.date)}</p>
                </div>
                <div class="recent-item-status">
                    <span class="status-${payment.status || 'completed'}">${getStatusText(payment.status || 'completed')}</span>
                </div>
            `;
            container.appendChild(item);
        });
    }

    // ==== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ====
    async function loadNotifications() {
        try {
            const response = await fetch('/api/notifications');
            if (response.ok) {
                const notifications = await response.json();
                displayNotifications(notifications);
                updateNotificationBadge(notifications.length);
                return notifications;
            }
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:', error);
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const container = document.getElementById('notifications');
            if (container) {
                container.innerHTML = '<p class="no-data">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</p>';
            }
        }
    }

    // ==== Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ====
    function displayNotifications(notifications) {
        const container = document.getElementById('notifications');
        if (!container) return;
        
        container.innerHTML = '';
        
        if (notifications.length === 0) {
            container.innerHTML = '<p class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</p>';
            return;
        }
        
        notifications.forEach(notification => {
            const item = document.createElement('div');
            item.className = `notification-item ${notification.type || 'info'}`;
            item.innerHTML = `
                <div class="notification-icon">
                    ${getNotificationIcon(notification.type || 'info')}
                </div>
                <div class="notification-content">
                    <h4>${notification.title || 'Ø¥Ø´Ø¹Ø§Ø±'}</h4>
                    <p>${notification.message || notification.content || ''}</p>
                    <small>${formatDate(notification.createdAt || notification.created_at)}</small>
                </div>
                <button onclick="markAsRead(${notification.id})" class="mark-read">âœ“</button>
            `;
            container.appendChild(item);
        });
    }

    // ==== ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ====
    function updateNotificationBadge(count) {
        const badge = document.getElementById('notification-badge');
        if (badge) {
            if (count > 0) {
                badge.textContent = count;
                badge.style.display = 'inline';
            } else {
                badge.style.display = 'none';
            }
        }
    }

    // ==== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ====
    function getStatusText(status) {
        const statusMap = {
            'pending': 'Ù…Ø¹Ù„Ù‚',
            'paid': 'Ù…Ø¯ÙÙˆØ¹',
            'overdue': 'Ù…ØªØ£Ø®Ø±',
            'cancelled': 'Ù…Ù„ØºÙŠ',
            'completed': 'Ù…ÙƒØªÙ…Ù„'
        };
        return statusMap[status] || status;
    }

    function getNotificationIcon(type) {
        const iconMap = {
            'warning': 'âš ï¸',
            'info': 'â„¹ï¸',
            'success': 'âœ…',
            'error': 'âŒ',
            'reminder': 'ğŸ””'
        };
        return iconMap[type] || 'â„¹ï¸';
    }

    function formatDate(dateString) {
        if (!dateString) return '-';
        const date = new Date(dateString);
        return date.toLocaleDateString('ar-SA');
    }

    function formatCurrency(amount) {
        if (!amount) return '0 Ø±.Ø³';
        return new Intl.NumberFormat('ar-SA').format(amount) + ' Ø±.Ø³';
    }

    // ==== Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙƒÙ…Ù‚Ø±ÙˆØ¡ ====
    async function markAsRead(notificationId) {
        try {
            const response = await fetch(`/api/notifications/${notificationId}/read`, {
                method: 'PUT'
            });
            
            if (response.ok) {
                await loadNotifications(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                showSuccess('ØªÙ… ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ù…Ù‚Ø±ÙˆØ¡');
            }
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙƒÙ…Ù‚Ø±ÙˆØ¡:', error);
            showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±');
        }
    }

    // ==== ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹ Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ====
    async function quickRefresh() {
        showLoading('ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
        
        await Promise.all([
            loadDashboardStats(),
            loadRecentInvoices(),
            loadRecentPayments(),
            loadNotifications()
        ]);
        
        hideLoading();
        showSuccess('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
    }

    // ==== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ ====
    function showLoading(message) {
        const loading = document.getElementById('loading');
        if (loading) {
            loading.textContent = message;
            loading.style.display = 'block';
        }
    }

    function hideLoading() {
        const loading = document.getElementById('loading');
        if (loading) {
            loading.style.display = 'none';
        }
    }

    function showSuccess(message) {
        const success = document.getElementById('success-message');
        if (success) {
            success.textContent = message;
            success.style.display = 'block';
            setTimeout(() => success.style.display = 'none', 3000);
        }
        console.log(message);
    }

    function showError(message) {
        const error = document.getElementById('error-message');
        if (error) {
            error.textContent = message;
            error.style.display = 'block';
            setTimeout(() => error.style.display = 'none', 5000);
        }
        console.error(message);
    }

    // ==== Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© ====
    function animateNumber(element, targetValue, suffix = '') {
        const startValue = 0;
        const duration = 1000;
        const startTime = Date.now();
        
        function updateNumber() {
            const elapsed = Date.now() - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const currentValue = Math.floor(startValue + (targetValue - startValue) * progress);
            
            element.textContent = currentValue.toLocaleString() + suffix;
            
            if (progress < 1) {
                requestAnimationFrame(updateNumber);
            }
        }
        
        updateNumber();
    }

    // ==== Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ====
    function setupInvoiceSearch() {
        const searchInput = document.getElementById('invoiceSearch');
        if (searchInput) {
            searchInput.addEventListener('input', e => {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('#invoice-tbody tr').forEach(row => {
                    const isVisible = row.textContent.toLowerCase().includes(term);
                    row.style.display = isVisible ? '' : 'none';
                });
            });
        }
    }

    // ==== ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ====
    document.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...');
        
        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        Promise.all([
            loadDashboardStats(),
            loadRecentInvoices(),
            loadRecentPayments(),
            loadNotifications()
        ]).then(() => {
            console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­');
        }).catch(error => {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:', error);
            showError('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
        });
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø±ÙŠØ¹
        const refreshBtn = document.getElementById('refresh-btn');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', quickRefresh);
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
        setupInvoiceSearch();
    });

    // ==== ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ====
    setInterval(() => {
        console.log('ğŸ”„ ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª...');
        loadDashboardStats();
        loadNotifications();
    }, 60000); // ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©

    // ==== ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚ ====
    setInterval(() => {
        console.log('ğŸ”„ ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª...');
        loadRecentInvoices();
        loadRecentPayments();
    }, 300000); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
  </script>
</body>
</html>
